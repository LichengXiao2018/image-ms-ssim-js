{"version":3,"sources":["image-ms-ssim.min.js","/source/image-ms-ssim.min.js"],"names":["f","exports","module","define","window","o","global","n",1,"require","i","l","s","t","e","r","IR","ImageMSSSIM","SSIM","compare","image1","image2","windowSize","K1","K2","luminance","bitsPerComponent","WEIGHT","mssim","mcs","im1","im2","w","width","h","height","length","res","ssim","Math","floor","data","Uint8Array","channels","linear","msssim","pow","image-resize-linear","image-ssim",2,"ImageResizeLinear","from","to","fx","fy","fx0","fy0","rx","ry","rx1","ry1","p1","p2","p3","p4","w1","w2","w3","w4","sw","sh","lw","lh","ty","tx","c",3,"ImageSSIM","iteration","lumaValues1","lumaValues2","averageLumaValue1","averageLumaValue2","sigxy","sigsqx","sigsqy","numPixelsInWin","numerator","c1","c2","denominator","numWindows","Error","L","Internals","_iterate","Channels","callback","y","x","windowWidth","min","windowHeight","_lumaValuesForWindow","averageLuma1","_averageLuma","averageLuma2","image","array","lumaValues","Float32Array","ArrayBuffer","counter","maxj","j","offset","maxi","sumLuma"],"mappings":"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","file":"image-ms-ssim.min.js","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n;n=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,n.ImageMSSSIM=e()}}(function(){return function e(n,t,r){function i(o,h){if(!t[o]){if(!n[o]){var f=\"function\"==typeof require&&require;if(!h&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error(\"Cannot find module '\"+o+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}var l=t[o]={exports:{}};n[o][0].call(l.exports,function(e){var t=n[o][1][e];return i(t?t:e)},l,l.exports,e,n,t,r)}return t[o].exports}for(var a=\"function\"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){var r,i=e(\"image-ssim\"),a=e(\"image-resize-linear\");!function(e){\"use strict\";function n(e,n,t,r,o,h,f){void 0===t&&(t=8),void 0===r&&(r=.01),void 0===o&&(o=.03),void 0===h&&(h=!0),void 0===f&&(f=8);var s=[.0448,.2856,.3001,.2363,.1333],l=[],d=[],c=[],u=[],v=e.width,w=e.height;c[0]=e,u[0]=n;for(var g=0;g<s.length;g++){var p=i.compare(c[g],u[g],t,r,o,h,f);l[g]=p.ssim,d[g]=p.mcs,g<s.length-1&&(v=Math.floor(v/2),w=Math.floor(w/2),c[g+1]={width:v,height:w,data:new Uint8Array(v*w*e.channels),channels:e.channels},u[g+1]={width:v,height:w,data:new Uint8Array(v*w*n.channels),channels:n.channels},a.linear(c[g],c[g+1]),a.linear(u[g],u[g+1]))}var m=l[s.length-1];for(g=0;g<s.length-1;g++)m*=Math.pow(d[g],s[g]);return{msssim:m,ssim:l[0]}}e.compare=n}(r||(r={})),n.exports=r},{\"image-resize-linear\":2,\"image-ssim\":3}],2:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n){for(var t,r,i,a,o,h,f,s,l,d,c,u,v,w,g,p,m=e.width<n.width?(e.width-1)/n.width:e.width/n.width,y=e.height<n.height?(e.height-1)/n.height:e.height/n.height,M=e.width*e.channels,x=e.width-1,A=e.height-1,G=0;G<n.height;G++)for(var b=0;b<n.width;b++){t=b*m,r=G*y,i=Math.floor(t),a=Math.floor(r),l=i*e.channels+a*M,d=l+(x>i?e.channels:0),c=l+(A>a?M:0),u=c+(x>i?e.channels:0),o=t-i,h=r-a,f=1-o,s=1-h,v=f*s,w=o*s,g=f*h,p=o*h;for(var B=0;B<e.channels;B++)n.data[(b+G*n.width)*e.channels+B]=v*e.data[l+B]+w*e.data[d+B]+g*e.data[c+B]+p*e.data[u+B]}}e.linear=n}(r||(r={})),n.exports=r},{}],3:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n,r,i,a,o,h){function f(e,n,t,r){var i,a,o;i=a=o=0;for(var h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2),o+=Math.pow(n[h]-r,2),i+=(e[h]-t)*(n[h]-r);var f=e.length-1;a/=f,o/=f,i/=f;var s=(2*t*r+l)*(2*i+d),w=(Math.pow(t,2)+Math.pow(r,2)+l)*(a+o+d);u+=s/w,v+=(2*i+d)/(a+o+d),c++}if(void 0===r&&(r=8),void 0===i&&(i=.01),void 0===a&&(a=.03),void 0===o&&(o=!0),void 0===h&&(h=8),e.width!==n.width||e.height!==n.height)throw new Error(\"Images have different sizes!\");var s=(1<<h)-1,l=Math.pow(i*s,2),d=Math.pow(a*s,2),c=0,u=0,v=0;return t._iterate(e,n,r,o,f),{ssim:u/c,mcs:v/c}}!function(e){e[e.Grey=1]=\"Grey\",e[e.GreyAlpha=2]=\"GreyAlpha\",e[e.RGB=3]=\"RGB\",e[e.RGBAlpha=4]=\"RGBAlpha\"}(e.Channels||(e.Channels={}));e.Channels;e.compare=n;var t;!function(e){function n(e,n,i,a,o){for(var h=e.width,f=e.height,s=0;f>s;s+=i)for(var l=0;h>l;l+=i){var d=Math.min(i,h-l),c=Math.min(i,f-s),u=t(e,l,s,d,c,a),v=t(n,l,s,d,c,a),w=r(u),g=r(v);o(u,v,w,g)}}function t(e,n,t,r,i,a){for(var o=e.data,h=new Float32Array(new ArrayBuffer(r*i*4)),f=0,s=t+i,l=t;s>l;l++){var d=l*e.width,c=(d+n)*e.channels,u=(d+n+r)*e.channels;switch(e.channels){case 1:for(;u>c;)h[f++]=o[c++];break;case 2:for(;u>c;)h[f++]=o[c++]*(o[c++]/255);break;case 3:if(a)for(;u>c;)h[f++]=.212655*o[c++]+.715158*o[c++]+.072187*o[c++];else for(;u>c;)h[f++]=o[c++]+o[c++]+o[c++];break;case 4:if(a)for(;u>c;)h[f++]=(.212655*o[c++]+.715158*o[c++]+.072187*o[c++])*(o[c++]/255);else for(;u>c;)h[f++]=(o[c++]+o[c++]+o[c++])*(o[c++]/255)}}return h}function r(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n/e.length}e._iterate=n}(t||(t={}))}(r||(r={})),n.exports=r},{}]},{},[1])(1)});\n//# sourceMappingURL=image-ms-ssim.min.js.map","!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n;n=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,n.ImageMSSSIM=e()}}(function(){return function e(n,t,r){function i(o,h){if(!t[o]){if(!n[o]){var f=\"function\"==typeof require&&require;if(!h&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error(\"Cannot find module '\"+o+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}var l=t[o]={exports:{}};n[o][0].call(l.exports,function(e){var t=n[o][1][e];return i(t?t:e)},l,l.exports,e,n,t,r)}return t[o].exports}for(var a=\"function\"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){var r,i=e(\"image-ssim\"),a=e(\"image-resize-linear\");!function(e){\"use strict\";function n(e,n,t,r,o,h,f){void 0===t&&(t=8),void 0===r&&(r=.01),void 0===o&&(o=.03),void 0===h&&(h=!0),void 0===f&&(f=8);var s=[.0448,.2856,.3001,.2363,.1333],l=[],d=[],c=[],u=[],v=e.width,w=e.height;c[0]=e,u[0]=n;for(var g=0;g<s.length;g++){var p=i.compare(c[g],u[g],t,r,o,h,f);l[g]=p.ssim,d[g]=p.mcs,g<s.length-1&&(v=Math.floor(v/2),w=Math.floor(w/2),c[g+1]={width:v,height:w,data:new Uint8Array(v*w*e.channels),channels:e.channels},u[g+1]={width:v,height:w,data:new Uint8Array(v*w*n.channels),channels:n.channels},a.linear(c[g],c[g+1]),a.linear(u[g],u[g+1]))}var m=l[s.length-1];for(g=0;g<s.length-1;g++)m*=Math.pow(d[g],s[g]);return{msssim:m,ssim:l[0]}}e.compare=n}(r||(r={})),n.exports=r},{\"image-resize-linear\":2,\"image-ssim\":3}],2:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n){for(var t,r,i,a,o,h,f,s,l,d,c,u,v,w,g,p,m=e.width<n.width?(e.width-1)/n.width:e.width/n.width,y=e.height<n.height?(e.height-1)/n.height:e.height/n.height,M=e.width*e.channels,x=e.width-1,A=e.height-1,G=0;G<n.height;G++)for(var b=0;b<n.width;b++){t=b*m,r=G*y,i=Math.floor(t),a=Math.floor(r),l=i*e.channels+a*M,d=l+(x>i?e.channels:0),c=l+(A>a?M:0),u=c+(x>i?e.channels:0),o=t-i,h=r-a,f=1-o,s=1-h,v=f*s,w=o*s,g=f*h,p=o*h;for(var B=0;B<e.channels;B++)n.data[(b+G*n.width)*e.channels+B]=v*e.data[l+B]+w*e.data[d+B]+g*e.data[c+B]+p*e.data[u+B]}}e.linear=n}(r||(r={})),n.exports=r},{}],3:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n,r,i,a,o,h){function f(e,n,t,r){var i,a,o;i=a=o=0;for(var h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2),o+=Math.pow(n[h]-r,2),i+=(e[h]-t)*(n[h]-r);var f=e.length-1;a/=f,o/=f,i/=f;var s=(2*t*r+l)*(2*i+d),w=(Math.pow(t,2)+Math.pow(r,2)+l)*(a+o+d);u+=s/w,v+=(2*i+d)/(a+o+d),c++}if(void 0===r&&(r=8),void 0===i&&(i=.01),void 0===a&&(a=.03),void 0===o&&(o=!0),void 0===h&&(h=8),e.width!==n.width||e.height!==n.height)throw new Error(\"Images have different sizes!\");var s=(1<<h)-1,l=Math.pow(i*s,2),d=Math.pow(a*s,2),c=0,u=0,v=0;return t._iterate(e,n,r,o,f),{ssim:u/c,mcs:v/c}}!function(e){e[e.Grey=1]=\"Grey\",e[e.GreyAlpha=2]=\"GreyAlpha\",e[e.RGB=3]=\"RGB\",e[e.RGBAlpha=4]=\"RGBAlpha\"}(e.Channels||(e.Channels={}));e.Channels;e.compare=n;var t;!function(e){function n(e,n,i,a,o){for(var h=e.width,f=e.height,s=0;f>s;s+=i)for(var l=0;h>l;l+=i){var d=Math.min(i,h-l),c=Math.min(i,f-s),u=t(e,l,s,d,c,a),v=t(n,l,s,d,c,a),w=r(u),g=r(v);o(u,v,w,g)}}function t(e,n,t,r,i,a){for(var o=e.data,h=new Float32Array(new ArrayBuffer(r*i*4)),f=0,s=t+i,l=t;s>l;l++){var d=l*e.width,c=(d+n)*e.channels,u=(d+n+r)*e.channels;switch(e.channels){case 1:for(;u>c;)h[f++]=o[c++];break;case 2:for(;u>c;)h[f++]=o[c++]*(o[c++]/255);break;case 3:if(a)for(;u>c;)h[f++]=.212655*o[c++]+.715158*o[c++]+.072187*o[c++];else for(;u>c;)h[f++]=o[c++]+o[c++]+o[c++];break;case 4:if(a)for(;u>c;)h[f++]=(.212655*o[c++]+.715158*o[c++]+.072187*o[c++])*(o[c++]/255);else for(;u>c;)h[f++]=(o[c++]+o[c++]+o[c++])*(o[c++]/255)}}return h}function r(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n/e.length}e._iterate=n}(t||(t={}))}(r||(r={})),n.exports=r},{}]},{},[1])(1)});\n//# sourceMappingURL=image-ms-ssim.min.js.map"],"sourceRoot":"/source/"}