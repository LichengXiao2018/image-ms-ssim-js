{"version":3,"sources":["image-ms-ssim.min.js","/source/image-ms-ssim.min.js"],"names":["f","exports","module","define","window","require","global","ImageMSSSIM","a","Error","n","s","t","code","r","o","length","SSIM","i","e",1,"IR","compare","image1","image2","windowSize","K1","K2","luminance","bitsPerComponent","WEIGHT","mssim","mcs","im1","im2","w","width","h","height","l","res","ssim","Math","floor","data","Uint8Array","channels","linear","msssim","pow","image-resize-linear","image-ssim",2,"ImageResizeLinear","from","to","fx","fy","fx0","fy0","rx","ry","rx1","ry1","p1","p2","p3","p4","w1","w2","w3","w4","sw","sh","lw","lh","ty","tx","c",3,"ImageSSIM","iteration","lumaValues1","lumaValues2","averageLumaValue1","averageLumaValue2","sigxy","sigsqx","sigsqy","numPixelsInWin","numerator","c1","c2","denominator","numWindows","L","Internals","_iterate","Channels","callback","y","x","windowWidth","min","windowHeight","_lumaValuesForWindow","averageLuma1","_averageLuma","averageLuma2","image","array","lumaValues","Float32Array","ArrayBuffer","counter","maxj","j","offset","maxi","sumLuma"],"mappings":"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","file":"image-ms-ssim.min.js","sourcesContent":["!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n;n=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,n.ImageMSSSIM=e()}}(function(){return function e(n,t,r){function i(o,h){if(!t[o]){if(!n[o]){var f=\"function\"==typeof require&&require;if(!h&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error(\"Cannot find module '\"+o+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}var l=t[o]={exports:{}};n[o][0].call(l.exports,function(e){var t=n[o][1][e];return i(t?t:e)},l,l.exports,e,n,t,r)}return t[o].exports}for(var a=\"function\"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){var r,i=e(\"image-ssim\"),a=e(\"image-resize-linear\");!function(e){\"use strict\";function n(e,n,t,r,o,h,f){void 0===t&&(t=8),void 0===r&&(r=.01),void 0===o&&(o=.03),void 0===h&&(h=!0),void 0===f&&(f=8);var s=[.0448,.2856,.3001,.2363,.1333],l=[],d=[],c=[],u=[],v=e.width,w=e.height;c[0]=e,u[0]=n;for(var g=0;g<s.length;g++){var p=i.compare(c[g],u[g],t,r,o,h,f);l[g]=p.ssim,d[g]=p.mcs,g<s.length-1&&(v=Math.floor(v/2),w=Math.floor(w/2),c[g+1]={width:v,height:w,data:new Uint8Array(v*w*e.channels),channels:e.channels},u[g+1]={width:v,height:w,data:new Uint8Array(v*w*n.channels),channels:n.channels},a.linear(c[g],c[g+1]),a.linear(u[g],u[g+1]))}var m=l[s.length-1];for(g=0;g<s.length-1;g++)m*=Math.pow(d[g],s[g]);return{msssim:m,ssim:l[0]}}e.compare=n}(r||(r={})),n.exports=r},{\"image-resize-linear\":2,\"image-ssim\":3}],2:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n){for(var t,r,i,a,o,h,f,s,l,d,c,u,v,w,g,p,m=e.width<n.width?(e.width-1)/n.width:e.width/n.width,y=e.height<n.height?(e.height-1)/n.height:e.height/n.height,M=e.width*e.channels,x=e.width-1,A=e.height-1,G=0;G<n.height;G++)for(var b=0;b<n.width;b++){t=b*m,r=G*y,i=Math.floor(t),a=Math.floor(r),l=i*e.channels+a*M,d=l+(x>i?e.channels:0),c=l+(A>a?M:0),u=c+(x>i?e.channels:0),o=t-i,h=r-a,f=1-o,s=1-h,v=f*s,w=o*s,g=f*h,p=o*h;for(var B=0;B<e.channels;B++)n.data[(b+G*n.width)*e.channels+B]=v*e.data[l+B]+w*e.data[d+B]+g*e.data[c+B]+p*e.data[u+B]}}e.linear=n}(r||(r={})),n.exports=r},{}],3:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n,r,i,a,o,h){function f(e,n,t,r){var i,a,o;i=a=o=0;for(var h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2),o+=Math.pow(n[h]-r,2),i+=(e[h]-t)*(n[h]-r);var f=e.length-1;a/=f,o/=f,i/=f;var s=(2*t*r+l)*(2*i+d),w=(Math.pow(t,2)+Math.pow(r,2)+l)*(a+o+d);u+=s/w,v+=(2*i+d)/(a+o+d),c++}if(void 0===r&&(r=8),void 0===i&&(i=.01),void 0===a&&(a=.03),void 0===o&&(o=!0),void 0===h&&(h=8),e.width!==n.width||e.height!==n.height)throw new Error(\"Images have different sizes!\");var s=(1<<h)-1,l=Math.pow(i*s,2),d=Math.pow(a*s,2),c=0,u=0,v=0;return t._iterate(e,n,r,o,f),{ssim:u/c,mcs:v/c}}!function(e){e[e.Grey=1]=\"Grey\",e[e.GreyAlpha=2]=\"GreyAlpha\",e[e.RGB=3]=\"RGB\",e[e.RGBAlpha=4]=\"RGBAlpha\"}(e.Channels||(e.Channels={}));e.Channels;e.compare=n;var t;!function(e){function n(e,n,i,a,o){for(var h=e.width,f=e.height,s=0;f>s;s+=i)for(var l=0;h>l;l+=i){var d=Math.min(i,h-l),c=Math.min(i,f-s),u=t(e,l,s,d,c,a),v=t(n,l,s,d,c,a),w=r(u),g=r(v);o(u,v,w,g)}}function t(e,n,t,r,i,a){for(var o=e.data,h=new Float32Array(new ArrayBuffer(r*i*4)),f=0,s=t+i,l=t;s>l;l++){var d=l*e.width,c=(d+n)*e.channels,u=(d+n+r)*e.channels;switch(e.channels){case 1:for(;u>c;)h[f++]=o[c++];break;case 2:for(;u>c;)h[f++]=o[c++]*(o[c++]/255);break;case 3:if(a)for(;u>c;)h[f++]=.212655*o[c++]+.715158*o[c++]+.072187*o[c++];else for(;u>c;)h[f++]=o[c++]+o[c++]+o[c++];break;case 4:if(a)for(;u>c;)h[f++]=(.212655*o[c++]+.715158*o[c++]+.072187*o[c++])*(o[c++]/255);else for(;u>c;)h[f++]=(o[c++]+o[c++]+o[c++])*(o[c++]/255)}}return h}function r(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n/e.length}e._iterate=n}(t||(t={}))}(r||(r={})),n.exports=r},{}]},{},[1])(1)});\n//# sourceMappingURL=image-ms-ssim.min.js.map","!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var n;n=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,n.ImageMSSSIM=e()}}(function(){return function e(n,t,r){function i(o,h){if(!t[o]){if(!n[o]){var f=\"function\"==typeof require&&require;if(!h&&f)return f(o,!0);if(a)return a(o,!0);var s=new Error(\"Cannot find module '\"+o+\"'\");throw s.code=\"MODULE_NOT_FOUND\",s}var l=t[o]={exports:{}};n[o][0].call(l.exports,function(e){var t=n[o][1][e];return i(t?t:e)},l,l.exports,e,n,t,r)}return t[o].exports}for(var a=\"function\"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,n,t){var r,i=e(\"image-ssim\"),a=e(\"image-resize-linear\");!function(e){\"use strict\";function n(e,n,t,r,o,h,f){void 0===t&&(t=8),void 0===r&&(r=.01),void 0===o&&(o=.03),void 0===h&&(h=!0),void 0===f&&(f=8);var s=[.0448,.2856,.3001,.2363,.1333],l=[],d=[],c=[],u=[],v=e.width,w=e.height;c[0]=e,u[0]=n;for(var g=0;g<s.length;g++){var p=i.compare(c[g],u[g],t,r,o,h,f);l[g]=p.ssim,d[g]=p.mcs,g<s.length-1&&(v=Math.floor(v/2),w=Math.floor(w/2),c[g+1]={width:v,height:w,data:new Uint8Array(v*w*e.channels),channels:e.channels},u[g+1]={width:v,height:w,data:new Uint8Array(v*w*n.channels),channels:n.channels},a.linear(c[g],c[g+1]),a.linear(u[g],u[g+1]))}var m=l[s.length-1];for(g=0;g<s.length-1;g++)m*=Math.pow(d[g],s[g]);return{msssim:m,ssim:l[0]}}e.compare=n}(r||(r={})),n.exports=r},{\"image-resize-linear\":2,\"image-ssim\":3}],2:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n){for(var t,r,i,a,o,h,f,s,l,d,c,u,v,w,g,p,m=e.width<n.width?(e.width-1)/n.width:e.width/n.width,y=e.height<n.height?(e.height-1)/n.height:e.height/n.height,M=e.width*e.channels,x=e.width-1,A=e.height-1,G=0;G<n.height;G++)for(var b=0;b<n.width;b++){t=b*m,r=G*y,i=Math.floor(t),a=Math.floor(r),l=i*e.channels+a*M,d=l+(x>i?e.channels:0),c=l+(A>a?M:0),u=c+(x>i?e.channels:0),o=t-i,h=r-a,f=1-o,s=1-h,v=f*s,w=o*s,g=f*h,p=o*h;for(var B=0;B<e.channels;B++)n.data[(b+G*n.width)*e.channels+B]=v*e.data[l+B]+w*e.data[d+B]+g*e.data[c+B]+p*e.data[u+B]}}e.linear=n}(r||(r={})),n.exports=r},{}],3:[function(e,n,t){var r;!function(e){\"use strict\";function n(e,n,r,i,a,o,h){function f(e,n,t,r){var i,a,o;i=a=o=0;for(var h=0;h<e.length;h++)a+=Math.pow(e[h]-t,2),o+=Math.pow(n[h]-r,2),i+=(e[h]-t)*(n[h]-r);var f=e.length-1;a/=f,o/=f,i/=f;var s=(2*t*r+l)*(2*i+d),w=(Math.pow(t,2)+Math.pow(r,2)+l)*(a+o+d);u+=s/w,v+=(2*i+d)/(a+o+d),c++}if(void 0===r&&(r=8),void 0===i&&(i=.01),void 0===a&&(a=.03),void 0===o&&(o=!0),void 0===h&&(h=8),e.width!==n.width||e.height!==n.height)throw new Error(\"Images have different sizes!\");var s=(1<<h)-1,l=Math.pow(i*s,2),d=Math.pow(a*s,2),c=0,u=0,v=0;return t._iterate(e,n,r,o,f),{ssim:u/c,mcs:v/c}}!function(e){e[e.Grey=1]=\"Grey\",e[e.GreyAlpha=2]=\"GreyAlpha\",e[e.RGB=3]=\"RGB\",e[e.RGBAlpha=4]=\"RGBAlpha\"}(e.Channels||(e.Channels={}));e.Channels;e.compare=n;var t;!function(e){function n(e,n,i,a,o){for(var h=e.width,f=e.height,s=0;f>s;s+=i)for(var l=0;h>l;l+=i){var d=Math.min(i,h-l),c=Math.min(i,f-s),u=t(e,l,s,d,c,a),v=t(n,l,s,d,c,a),w=r(u),g=r(v);o(u,v,w,g)}}function t(e,n,t,r,i,a){for(var o=e.data,h=new Float32Array(new ArrayBuffer(r*i*4)),f=0,s=t+i,l=t;s>l;l++){var d=l*e.width,c=(d+n)*e.channels,u=(d+n+r)*e.channels;switch(e.channels){case 1:for(;u>c;)h[f++]=o[c++];break;case 2:for(;u>c;)h[f++]=o[c++]*(o[c++]/255);break;case 3:if(a)for(;u>c;)h[f++]=.212655*o[c++]+.715158*o[c++]+.072187*o[c++];else for(;u>c;)h[f++]=o[c++]+o[c++]+o[c++];break;case 4:if(a)for(;u>c;)h[f++]=(.212655*o[c++]+.715158*o[c++]+.072187*o[c++])*(o[c++]/255);else for(;u>c;)h[f++]=(o[c++]+o[c++]+o[c++])*(o[c++]/255)}}return h}function r(e){for(var n=0,t=0;t<e.length;t++)n+=e[t];return n/e.length}e._iterate=n}(t||(t={}))}(r||(r={})),n.exports=r},{}]},{},[1])(1)});\n//# sourceMappingURL=image-ms-ssim.min.js.map"],"sourceRoot":"/source/"}